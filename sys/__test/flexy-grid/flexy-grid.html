<div class="panel panel-primary flexy-grid {{table}}" ng-controller="GridController">

  <div class="panel-heading panel-title">
    <!-- Title -->
    <h3 class="pull-left">{{ui_name}}</h3>
    <!-- Search FORM -->
    <form class="form-inline has-feedback pull-right">
      <label class="control-label sr-only" for="grid-search">Search</label>
      <input id="grid-search" class="form-control input-sm" type="search" ng-model="search"/>
      <span class="glyphicon glyphicon-search form-control-feedback text-primary"></span>
    </form>
  </div>

  <div class="panel-content">
    <table st-delay="200" st-table="displayedItems" st-safe-src="gridItems"
      class="table table-striped table-hover table-condensed table-responsive table-bordered"
      ng-class="{'table-sortable': type.is_sortable, 'table-tree': type.is_tree}">

      <!-- Table Head -->
      <thead>
        
        <!-- Hidden Search FORM -->
        <tr>
          <th colspan="2">
            <form class="form-inline has-feedback pull-right">
              <input st-search ng-model="search" />
            </form>
          </th>
        </tr>
        
        <!--Columns -->
        <tr>
          <th class="edit">
            <div class="btn-group btn-group-xs">
              <div class="btn btn-primary action-new"><span class="glyphicon glyphicon-plus"></span></div>
            </div>
            <div class="btn-group btn-group-xs">
              <div class="btn btn-info action-select" ng-click="toggleSelection()"><span class="flexy-grid-unselected glyphicon glyphicon-unchecked"></div>
              <div class="btn btn-danger action-remove"><span class="glyphicon glyphicon-remove"></span></div>
            </div>
          </th>
          
          <th ng-if="type.is_sortable" ng-repeat="field in fields | toArray" st-sort="{{field.field}}" class="flexy-grid-sortable-column {{field.type}} {{field.field}}">{{field.ui_name}}
            <span class="glyphicon glyphicon-chevron-up"></span>
            <span class="glyphicon glyphicon-chevron-down"></span>
          </th>
          
          <th ng-if="!type.is_sortable" ng-repeat="field in fields | toArray" class="{{field.type}} {{field.field}}">{{field.ui_name}}</th>
        </tr>
        
      </thead>

      <!-- Table Body -->
      <tbody>
        <tr ng-repeat="row in displayedItems"
            st-select-row="row" st-select-mode="multiple"
            ng-class="{'flexy-tree-has_children':row._info.has_children, 'flexy-tree-child':row._info.is_child, 'flexy-grid-selected':row._info.selected}"
            tree-level="{{row._info.level}}"
            id="{{row.id}}">

          <!-- Row Actions -->
          <td class="actions">
            <div class="btn-group btn-group-xs">
              <!-- Edit button -->
              <a ng-href="{{base_url}}#form/{{table}}/{{row.id}}" class="btn btn-primary action-edit"><span class="glyphicon glyphicon-pencil"></span></a>
            </div>
            <div class="btn-group btn-group-xs">
              <!-- Select button -->
              <div class="btn btn-info action-select"><span class="flexy-grid-unselected glyphicon glyphicon-unchecked"></span><span class="flexy-grid-selected glyphicon glyphicon-check"></span></div>
              <!-- Delete button -->
              <div class="btn btn-danger action-remove"><span class="glyphicon glyphicon-remove"></span></div>
            </div>
            <div class="btn-group btn-group-xs sortable-handle">
              <!-- Order button -->
              <div class="btn btn-warning action-move"><span class="glyphicon glyphicon-resize-vertical"></span></div>
            </div>
          </td>

          <!-- Field Values -->
          <td ng-repeat="key in orderedKeys(row)" class="{{fields[key].type}} {{key}}">
            {{row[key]}}
          </td>

        </tr>
      </tbody>
      
      <tfoot>
  			<tr>
  				<td colspan="0" class="text-primary">
            <div>
              <!-- Pagination -->
    					<div class="flexy-grid-pagination" st-pagination="" st-template="flexy-grid/flexy-grid-pagination.html" st-items-by-page="info.limit" st-displayed-pages="info.displayed_pages"></div>
              <!-- Info -->
              <div class="flexy-grid-stats">{{info.rows}} items on {{info.total_pages}} pages</div>
            </div>
  				</td>
  			</tr>
  		</tfoot>
      
    </table>
  </div>
</div>
