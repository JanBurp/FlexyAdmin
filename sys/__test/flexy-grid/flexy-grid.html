<div class="panel panel-primary flexy-grid {{table}}" st-table="grid.displayedItems" st-safe-src="grid.items">

  <div class="panel-heading panel-title">
    <h3 class="pull-left">{{grid.table_info.ui_name}}</h3>
    <form class="form-inline has-feedback pull-right">
      <label class="control-label sr-only" for="grid-search">Search</label>
      <input id="grid-search" st-search class="form-control input-sm" type="search"/>
      <span class="glyphicon glyphicon-search form-control-feedback text-primary"></span>
    </form>
  </div>

  <div class="panel-content">
    <table class="table table-striped table-hover table-condensed table-responsive table-bordered" ng-class="{'table-sortable': grid.table_info.sortable, 'table-tree': grid.table_info.tree}">
      
      <thead>
        <tr>
          <th class="edit"><div class="btn btn-primary btn-xs action-new"><span class="glyphicon glyphicon-plus"></span></div></th>
          <th ng-if="grid.table_info.sortable" ng-repeat="field in grid.field_info | toArray" st-sort="{{field.field}}" class="{{field.type}} {{field.field}}">{{field.ui_name}}
            <span class="glyphicon glyphicon-chevron-up"></span>
            <span class="glyphicon glyphicon-chevron-down"></span>
          </th>
          <th ng-if="!grid.table_info.sortable" ng-repeat="field in grid.field_info | toArray" class="{{field.type}} {{field.field}}">{{field.ui_name}}</th>
        </tr>
      </thead>
      
      <tbody sortable="sortableOptions" ng-model="grid.items">
        
        <tr ng-repeat="row in grid.displayedItems" ng-class="{'flexy-tree-branch':row._info.is_branch, 'flexy-tree-node':row._info.is_node}" tree-level="{{row._info.level}}" id="{{row.id}}" sortable-item>
          <td class="edit">
            <div class="btn-group btn-group-xs">
              <div class="btn btn-primary action-edit"><span class="glyphicon glyphicon-pencil"></span></div>
              <div class="btn btn-danger action-remove"><span class="glyphicon glyphicon-remove"></span></div>
            </div>
            <div class="btn-group btn-group-xs" ng-if="!grid.table_info.sortable" sortable-item-handle>
              <div class="btn btn-warning action-move"><span class="glyphicon glyphicon-resize-vertical"></span></div>
            </div>
          </td>
          <td ng-repeat="key in keys(row)" class="{{grid.field_info[key].type}} {{key}}">
            <span ng-if="grid.table_info.tree && key=='str_title'" class="flexy-grid-branch-expanded glyphicon glyphicon-chevron-down"></span>
            <span ng-if="grid.table_info.tree && key=='str_title'" class="flexy-grid-branch-collapsed glyphicon glyphicon-chevron-right"></span>
            <span class="flexy-grid-celldata">{{row[key]}}</span>
          </td>
        </tr>
        
      </tbody>
      
    </table>
  </div>
  
  <div class="panel-footer text-primary">
    <span st-pagination="" st-items-by-page="pagination.itemsPerPage" st-displayed-pages="pagination.displayedPages"></span>
    <span class="table-stats">{{pagination.totalItems}} items on {{pagination.totalPages}} pages</span>
  </div>
</div>
