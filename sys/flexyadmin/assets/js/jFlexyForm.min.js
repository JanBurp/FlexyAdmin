function doForm(){if(typeof(formFieldWhen)!="undefined"){var a=$(".form_field");$(a).each(function(){var d=$(this).attr("class");d=d.split(" ");d=d[2];if(typeof(formFieldWhen[d])!="undefined"){var c=formFieldWhen[d];$("#"+c.actor).change(function(){var e=$(this).val();$(".form_field."+c.field).add("#"+d).addClass("hidden");switch(c.operator){case"=":if(e==c.value){$(".form_field."+c.field).add("#"+d).removeClass("hidden")}break;case">":if(e>c.value){$(".form_field."+c.field).add("#"+d).removeClass("hidden")}break;case"<":if(e<c.value){$(".form_field."+c.field).add("#"+d).removeClass("hidden")}break}if(!$(".form_field."+c.field).hasClass("hidden")){$(".form_field."+c.field).css({"min-height":"27px"})}})}})}$(".form_field select").each(function(){selHeight=$(this).outerHeight();imgList=$(this).parent(".form_field:first").children("ul.multiple:first");if(imgList.length>0){selHeight+=$(imgList).outerHeight()}$(this).parent(".form_field:first").css({height:selHeight})});$(".form_field.image_dragndrop").each(function(){selHeight=$(this).children("ul.choices").outerHeight();selHeight+=$(this).children("ul.values").outerHeight();$(this).css({height:selHeight+4})});$("form input.datetime").each(function(){var f=$(this).attr("value");var j=$(this).attr("class");var i=$(this).attr("id");var e=i+"__date";var h=i+"__time";f=f.split(" ");var d=f[0];var g=f[1];$(this).after('<input id="'+h+'" name="'+h+'" class="'+j+' time" value="'+g+'">');$(this).after('<input id="'+e+'" name="'+e+'" class="'+j+' date" value="'+d+'">');$(this).hide();$("#"+e).add("#"+h).change(function(){f=$("#"+e).val()+" "+$("#"+h).val();$("#"+i).attr("value",f)})});$("form input.date").datepicker({dateFormat:"yy-mm-dd"});$("form input.time").timepicker({hourCols:6,minDivision:5,hourCaption:lang("ui-timepicker-choose-hours"),minuteCaption:lang("ui-timepicker-choose-minutes"),closeOnFormclick:true});$("form input.rgb").each(function(){var c=$(this).val();$(this).after('<div class="rgbColor" style="background-color:'+c+';" color="'+c+'"></div>');$(this).change(function(){var d=$(this).next(".rgbColor");var e=$(this).val();$(d).css({"background-color":e}).attr("color",e)});$(this).next(".rgbColor").click(function(){$(this).ColorPicker({onBeforeShow:function(){self=this;var d=$(this).attr("color");$(this).ColorPickerSetColor(d)},onSubmit:function(d,h,f,g){var e="#"+h.toUpperCase();$(g).css({"background-color":e}).attr("color",e).prev("input.rgb:first").val(e);$(g).ColorPickerHide()},onChange:function(d,g,f){var e="#"+g.toUpperCase();$(self).css({"background-color":e}).prev("input.rgb:first").val(e)}})}).trigger("click")});$("form input.password").after('<span class="button">'+lang("form_random_password")+"</span>");$("form span.button").click(function(){pwd=randomPassword(10);$(this).prev("input.password").attr("value",pwd)});$("div.image_dropdown select.medias optgroup:first option:selected").attr("selected","");var b=$("div.image_dropdown");$(b).each(function(){var h=$(this);var d=$(this).find("select");var c=$(d).hasClass("medias");var f=$(this).find("ul");var e=$(d).find("option");var g=$(d).attr("path")+"/";if(e.length>0){$(d).change(function(){$(f).find("li").remove();if(c){$(h).find("input:first").attr("value","")}var i=$(d).find("option:selected");var j="";if(i.length>0){$(i).each(function(){var m=$(this).attr("value");if(c&&j!=""){j=j+"|"+m}else{j=m}m=g+m;var l=get_ext(m);var k=32;if(c){k=25}if(l=="swf"||l=="flv"){$(h).find("ul:first").append("<li>"+flash(m,k,k)+"</li>")}else{m=cachedThumb(m);$(h).find("ul:first").append('<li><img class="media" src="'+m+'" /></li>')}});$(h).find("input:first").attr("value",j)}})}});$("div.media ul.choices li").click(function(){src=$(this).children("img:first").attr("src");$(this).parent("ul").parent("div.media").children("ul.values").empty();$(this).parent("ul").parent("div.media").children("ul.values").append('<li><img class="zoom" src="'+src+'" alt="'+src+'" title="'+src+'" /></li>');src=pathdecode(src);src=src.substr(src.lastIndexOf("/")+1);$(this).parent("ul").parent("div.media").children("input:first").attr("value",src)});$("div.media ul.values").click(function(){$(this).empty();$(this).parent("div.media").children("input:first").attr("value","")});$("div.medias ul").sortable({connectWith:"div.medias ul",update:function(c,e){if($(this).hasClass("values")){var d="";$(this).children("li").each(function(){var f=$(this).children("img:first").attr("src");if(f!=undefined){f=pathdecode(f);f=f.substr(f.lastIndexOf("/")+1);d+="|"+f}});d=d.substr(1);$(this).parent(".form_field:first").children("input:first").attr("value",d)}}});$("form").submit(function(){$("form .image_dragndrop input").each(function(){var c=$(this).attr("value");if(c=="flexyadmin_empty_image.gif"){$(this).attr("value","")}})});$("div.ordered_list ul").sortable({connectWith:"div.ordered_list ul",update:function(c,d){if($(this).hasClass("list_values")){value="";$(this).children("li").each(function(){id=$(this).attr("id");value+="|"+id});value=value.substr(1);$(this).parent(".form_field").children("input:first").attr("value",value)}}})};