function doForm(){if(typeof(formFieldWhen)!="undefined"){var a=$(".form_field");$(a).each(function(){var e=$(this).attr("class");e=e.split(" ");e=e[2];if(typeof(formFieldWhen[e])!="undefined"){var d=formFieldWhen[e];$("#"+d.actor).change(function(){var f=$(this).val();$(".form_field."+d.field).add("#"+e).addClass("hidden");switch(d.operator){case"=":if(f==d.value){$(".form_field."+d.field).add("#"+e).removeClass("hidden")}break;case">":if(f>d.value){$(".form_field."+d.field).add("#"+e).removeClass("hidden")}break;case"<":if(f<d.value){$(".form_field."+d.field).add("#"+e).removeClass("hidden")}break}if(!$(".form_field."+d.field).hasClass("hidden")){$(".form_field."+d.field).css({"min-height":"27px"})}})}})}$(".form_field select").each(function(){selHeight=$(this).outerHeight();imgList=$(this).parent(".form_field:first").children("ul.multiple:first");if(imgList.length>0){selHeight+=$(imgList).outerHeight()}$(this).parent(".form_field:first").css({height:selHeight})});$(".form_field.image_dragndrop").each(function(){selHeight=$(this).children("ul.choices").outerHeight();selHeight+=$(this).children("ul.values").outerHeight();$(this).css({height:selHeight+4})});$("form input.datetime").each(function(){var f=$(this).attr("value");var j=$(this).attr("class");var i=$(this).attr("id");var e=i+"__date";var h=i+"__time";f=f.split(" ");var d=f[0];var g=f[1];$(this).after('<input id="'+h+'" name="'+h+'" class="'+j+' time" value="'+g+'">');$(this).after('<input id="'+e+'" name="'+e+'" class="'+j+' date" value="'+d+'">');$(this).hide();$("#"+e).add("#"+h).change(function(){f=$("#"+e).val()+" "+$("#"+h).val();$("#"+i).attr("value",f)})});$("form input.date").datepicker({dateFormat:"yy-mm-dd"});$("form input.time").timepicker({hourCols:6,minDivision:5,hourCaption:lang("ui-timepicker-choose-hours"),minuteCaption:lang("ui-timepicker-choose-minutes"),closeOnFormclick:true});$("form input.rgb").each(function(){var d=$(this).val();$(this).after('<div class="rgbColor" style="background-color:'+d+';" color="'+d+'"></div>');$(this).change(function(){var e=$(this).next(".rgbColor");var f=$(this).val();$(e).css({"background-color":f}).attr("color",f)});$(this).next(".rgbColor").click(function(){$(this).ColorPicker({onBeforeShow:function(){self=this;var e=$(this).attr("color");$(this).ColorPickerSetColor(e)},onSubmit:function(e,i,g,h){var f="#"+i.toUpperCase();$(h).css({"background-color":f}).attr("color",f).prev("input.rgb:first").val(f);$(h).ColorPickerHide()},onChange:function(e,h,g){var f="#"+h.toUpperCase();$(self).css({"background-color":f}).prev("input.rgb:first").val(f)}})}).trigger("click")});$("form input.password").after('<span class="button">'+lang("form_random_password")+"</span>");$("form span.button").click(function(){pwd=randomPassword(10);$(this).prev("input.password").attr("value",pwd)});$("div.image_dropdown select.medias optgroup:first option:selected").attr("selected","");var c=$("div.image_dropdown");$(c).each(function(){var i=$(this);var e=$(this).find("select");var d=$(e).hasClass("medias");var g=$(this).find("ul");var f=$(e).find("option");var h=$(e).attr("path")+"/";if(f.length>0){$(e).change(function(){$(g).find("li").remove();if(d){$(i).find("input:first").attr("value","")}var j=$(e).find("option:selected");var k="";if(j.length>0){$(j).each(function(){var n=$(this).attr("value");if(d&&k!=""){k=k+"|"+n}else{k=n}n=h+n;var m=get_ext(n);var l=32;if(d){l=25}if(m=="swf"||m=="flv"){$(i).find("ul:first").append("<li>"+flash(n,l,l)+"</li>")}else{n=cachedThumb(n);$(i).find("ul:first").append('<li><img class="media" src="'+n+'" /></li>')}});$(i).find("input:first").attr("value",k)}})}});$("div.media ul.choices").add("div.medias ul.choices").add("div.medias ul.values").click(function(i){var h=i.target;var f="media";if($(h).parents("div:first").hasClass("medias")){f="medias"}var k=$(h).attr("src");if(f=="media"){var j=pathdecode(k);j=j.substr(j.lastIndexOf("/")+1);$(h).parents("div.media").children("ul.values").empty();$(h).parents("div.media").children("ul.values").append('<li><img class="zoom" src="'+k+'" alt="'+j+'" title="'+j+'" /></li>');$(h).parents("div.media").children("input:first").attr("value",j)}else{var g=$(h).parent("li:first").clone(true);var d=$(h).parents("div.medias").children("ul.values");if($(h).parents("ul:first").hasClass("choices")){$(h).parents("div.medias").children("ul.values").append(g)}else{$(h).parents("div.medias").children("ul.choices").append(g)}$(h).parent("li:first").remove();$(".zoomThumb").hide();b($(d))}});$("div.media ul.values").click(function(){$(this).empty();$(this).parent("div.media").children("input:first").attr("value","")});function b(e){if($(e).hasClass("values")){var d="";$(e).children("li").each(function(){var f=$(this).children("img:first").attr("src");if(f!=undefined){f=pathdecode(f);f=f.substr(f.lastIndexOf("/")+1);d+="|"+f}});d=d.substr(1);$(e).parent(".form_field:first").children("input:first").attr("value",d)}}$("div.medias ul").sortable({connectWith:"div.medias ul",update:function(d,e){b($(this))}});$("form").submit(function(){$("form .image_dragndrop input").each(function(){var d=$(this).attr("value");if(d=="flexyadmin_empty_image.gif"){$(this).attr("value","")}})});$("div.ordered_list ul").sortable({connectWith:"div.ordered_list ul",update:function(d,e){if($(this).hasClass("list_values")){value="";$(this).children("li").each(function(){id=$(this).attr("id");value+="|"+id});value=value.substr(1);$(this).parent(".form_field").children("input:first").attr("value",value)}}})};