(function(j){var k=false,F="",d={},g={},c={},b={},m={},p={},E={},v={},y={},C=[],r=function(){d.removeClass("ui-state highlight ui-state-active")},w=function(H){var J,I,G;j("#tbl_minute a").each(function(){J=j(this).html();G=J.split(":");if(H){d.hour=H}I=G[1];I=I.replace("am","");I=I.replace("pm","");j(this).html(d.hour+":"+I+"<i>"+F+"</i>")})},q=function(I){var G,H=false;d.minute=="0"?d.minute="00":void (0);G=d.hour+":"+d.minute+" "+F;c.html(G);if(I){G=G.replace(/ /g,"");G=G+":00";j(m).val(G);H=true;j(m).trigger("change")}j(g).trigger("onselect",[G,H])},u=function(){b.css({"background-color":"transparent"})},A=function(){b.fadeTo(300,0.3)},i=function(){E.slideDown(600)},D=function(){E.css("display","none")},B=function(){var J,L,H,K=j(m).offset(),M=j(m).height(),O=j(window).height(),N=j(document).scrollTop(),I=80,G=g.outerHeight();H=O-K.top+N-M-G-I;K.left+=v[m.identifier].offsetLeft;if(H>0){K.top+=M+v[m.identifier].offsetTop+10}else{K.top-=G+v[m.identifier].offsetTop+10}return K},f=function(){var K=v[m.identifier],H,I=1,L;H="<tr>";try{if(K.hourFormat==24){L=K.hour24.length;for(var G=0;G<L;G++){if(typeof(K.hour24[G])==="string"){H+='<td><a class="ui-timepicker-unselectable ui-state-disabled">'+K.hour24[G]+"</a></td>"}else{H+='<td><a rel="h_24_'+K.hour24[G]+'">'+K.hour24[G]+"</a></td>"}if(I==K.hourCols){H+="</tr><tr>";I=0}I++}}else{if(K.hourFormat==12){L=K.hourAM.length;for(var G=0;G<L;G++){if(typeof(K.hourAM[G])==="string"){H+='<td><a class="ui-timepicker-unselectable ui-state-disabled">'+K.hourAM[G]+"</a></td>"}else{H+='<td><a rel="h_am_'+K.hourAM[G]+'">'+K.hourAM[G]+"<i>am</i></a></td>"}if(I==K.hourCols){H+="</tr><tr>";I=0}I++}H+='</tr><tr><td colspan="'+K.hourCols+'" class="ui-timepicker-unselectable ui-timepicker-divider ui-state-disabled">&nbsp;</td></tr><tr>';I=1;L=K.hourPM.length;for(var G=0;G<L;G++){if(typeof(K.hourPM[G])==="string"){H+='<td><a class="ui-timepicker-unselectable ui-state-disabled">'+K.hourPM[G]+"</a></td>"}else{H+='<td><a rel="h_pm_'+K.hourPM[G]+'">'+K.hourPM[G]+"<i>pm</i></a></td>"}if(I==K.hourCols){H+="</tr><tr>";I=0}I++}}}}catch(J){H="<td>&nbsp;<td>"}H+="</tr>";return{html:H,cols:K.hourCols}},z=function(){var N=[],M,I,L,J=1,G;N[30]=[0,30];N[20]=[0,20,30];N[15]=[0,15,30,45];N[12]=[0,12,24,36,48];N[10]=[0,10,20,30,40,50];N[5]=[0,5,10,15,20,25,30,35,40,45,50,55];M=v[m.identifier].minDivision;try{if(typeof(M)==="number"){M=N[M]}if(typeof(M)==="undefined"){M=N[j.fn.timepicker.defaults.minDivision]}if(j.isArray(M)){L=M.length;G=6;if(L<7){G=L}else{if(L>6&&L<11){G=Math.round(L/2)}}I="<tr>";for(var H=0;H<L;H++){M[H]<10?M[H]="0"+M[H]:void (0);I+='<td><a rel="m_'+M[H]+'">00:'+M[H]+"</a></td>";if(J==G){I+="</tr><tr>";J=0}J++}I+="</tr>";return{html:I,cols:G}}else{I="<tr><td>&nbsp;</td></tr>";return{html:I,cols:G}}}catch(K){I="<tr><td>minDivision wrong format!"+K+"</td></tr>";return{html:I,cols:G}}},l=function(){var I=v[m.identifier],G=f(),J=z(),K='\n<div class="ui-timepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"><a class="ui-timepicker-close ui-datepicker-close ui-corner-all" title="Close" id="btn_close"><span class="ui-icon ui-icon-circle-close">Close</span></a><div class="ui-timepicker-title ui-datepicker-title"><span class="ui-timepicker-timeresult" id="timeresult">00:00</span></div></div>\n',H='<div id="hour_overlay"><table class="ui-timepicker-hourtable" id="tbl_uur"><thead><!-- clickhandler op td --><tr><th colspan="'+G.cols+'" class="ui-timepicker-header"><span class="ui-timepicker-title" title="Uren">'+I.hourCaption+"</span></th></tr></thead><tbody>"+G.html+'</tbody></table></div><div id="min_overlay"><table class="ui-timepicker-minutetable" id="tbl_minute"><thead><!-- clickhandler op td --><tr><th colspan="'+J.cols+'" class="ui-timepicker-header"><span class="ui-timepicker-title" title="Minuten">'+I.minuteCaption+"</span></th></tr></thead><tbody>"+J.html+"</tbody></table></div>";return K+H},n=function(G){if(G.target.className.indexOf("ui-")==-1){x();j("body").unbind("click.tp_hide")}},s=function(H){var J,G=[],I;if(typeof(H.target.rel)==="undefined"){J=H.target.parentNode.rel}else{J=H.target.rel}G=J.split("_");k=true;r();if(G[0]=="h"){I=G[1];if(I=="24"){I=""}F=I;d.hour=G[2];d.minute="00";w();q();A();i()}else{if(G[0]=="m"){d.minute=G[1];q(true);x()}else{return false}}j(H.target).addClass("ui-state highlight ui-state-active");k=false},t=function(G){if(G.id){G.identifier=G.id}else{if(G.name){G.identifier=G.name}else{G.identifier=0}}return G.identifier},o=function(G){return(typeof(G)!=="undefined"&&G!=={})},h=function(H,G){!H?H=500:void (0);var I=B();g.css({left:I.left,top:I.top});if(!G){g.trigger("beforeshow")}if(v[m.identifier].openOnClick||G){g.show(H)}},x=function(G){!G?G=300:void (0);g.hide(G);c.html("00:00");d.minute="00";g.trigger("onclose");u();r();w("00");D();k=false},e=function(H){var G=m;v[G.identifier]=j.extend({},j.fn.timepicker.defaults,j(y).data("timepicker"),j(G).data("timepicker"));g=j("#ui-timepicker-div");g.css("display","none");g.html(l());c=j("#timeresult");b=j("#hour_overlay");p=j("#btn_close");E=j("#min_overlay");d=j("#ui-timepicker-div table a");d.addClass("ui-state-default");E.css("overflow","hidden");p.click(j.timepicker.close);d.hover(function(){j(this).toggleClass("ui-state-hover")});if(v[G.identifier].closeOnFormclick){j("body").unbind("click.tp_hide").bind("click.tp_hide",n)}d.bind("click.tp",function(I){I.preventDefault();s(I)});g.unbind("beforeshow").bind("beforeshow",function(){v[G.identifier].beforeShow.apply(G,arguments)});g.unbind("onclose").bind("onclose",function(){v[G.identifier].onClose.apply(G,arguments)});g.unbind("onselect").bind("onselect",function(){v[G.identifier].onSelect.apply(G,arguments)});D();u();h()},a=function(){if(j("#ui-timepicker-wrap").length){return}j("body").append('\n\n<div class="ui-timepicker ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible" id="ui-timepicker-div"></div>\n\n')};j.fn.timepicker=function(G){var H={},I=j('<button class="ui-timepicker-button"></button>');G=typeof(G)==="undefined"?{}:G;if(G.inputReadOnly){j(this).attr("readonly","readonly")}if(o(G.button)){this.after(I);switch(G.button){case"default":I.append('<span class="ui-icon ui-icon-clock"></span>');I.addClass("ui-timepicker-defaultbutton");break;case"ui":if(o(G.buttonUI)){alert("development still in progress,sorry")}I.addClass("ui-timepicker-uibutton");break;case"image":I.css("background",'transparent url("clock.png") no-repeat');I.addClass("ui-timepicker-imgbutton");break;default:I.html(G.button);break}if(o(G.buttonCSS)){I.css(G.buttonCSS)}j(I).unbind("click.tp").bind("click.tp",function(J){J.preventDefault();H=this.previousSibling;k=true;j(H).blur();H.identifier=t(H);m=H;e();return false})}else{j(this).unbind("click.tp").bind("click.tp",function(J){J.preventDefault();if(k){return}k=true;j(this).blur();this.identifier=t(this);m=this;e();return false})}H.oButton=I[0];j(this).data("timepicker",j.extend({},G,H));return this};j.timepicker=function(G){if(typeof G==="object"){j(y).data("timepicker",G)}};j.timepicker.close=function(G){x(G)};j.timepicker.open=function(G){e(G)};j.timepicker.init=function(){a()};j.fn.timepicker.defaults={hour24:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],hourAM:[12,1,2,3,4,5,6,7,8,9,10,11],hourPM:[12,1,2,3,4,5,6,7,8,9,10,11],hourFormat:24,hourCols:8,minDivision:15,openOnClick:true,inputReadOnly:false,beforeShow:function(){},onSelect:function(){},onClose:function(){},hourCaption:"First choose the whole hour",minuteCaption:"Then choose the right time",button:"",buttonObj:{},offsetLeft:0,offsetTop:0,closeOnFormclick:false};j(document).ready(function(){a()})})(jQuery);